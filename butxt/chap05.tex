

\chapter{Dokumentácia} \label{docu}

Z programátorského hľadiska je práca rozdelená na tri časti. 
Prvú časť predstavuje získavanie výsledkov a kurzov jednotlivých zápasov. 
Druhú časť práce predstavuje transformácia dat na údaje priamo použiteľné pri konštrukcii neurónových sietí.
Poslednú časť tvorí stavba daného typu neurónovej siete pre daný šport.

Transformačná časť v prípade tenisu rozdelí data na 3 časti, trénovacie data, testovacie data (pre optimalizovanie siete) a vyhodnocovacie data.
V prípade futbalu data rozdelí na 2 časti, trénovacie a vyhodnocovacie data.
Pre optimalizáciu som použil program podobný programu v poslednej časti, ktorý si trénovacie data rozdelíl podľa potreby (konkrétne na prvých 6 celých sezón a prvú polovicu ďalšej a druhú časť tvorí druhá polovicu tejto sezóny, až následne prebiehalo učenie siete).
Je teda zaručené, že žiadna sieť neuvidí vyhodnocovacie data vopred pred finálnym vyhodnocovaním.
Vyhodnocovacie data sú použité až pre získavanie výsledkov použitých v tejto práci, a teda použili sa až v poslednej fáze.


Údaje, ktoré sa objavia vo výstupe sú celková úspešnosť a celkový zisk, úspešnosť a zisk siete pri vyrovnaných zápasoch (a vyrovnaný zápas považujem zápas, kde kurzy na výhru jedného alebo druhého tímu sa líšia najviac o 1) a úspešnosť a zisk siete pri výhradnom tipovaní zápasov, na ktoré máme istú dôveru (od hodnoty, ktorá je počítaná ako rozdiel dvoch najvyšších čísel, ktoré sieť vydá na výstup, jednoducho povedané, rozdiel najpravdepodobnejšej a druhej najpravdepodobnejšej možnosti výsledku zápasu z hľadiska siete).
Táto hodnota dôvery bola tiež vyoptimalizovaná pre každú sieť/program osobitne.


\section{Futbal}

Údaje o týchto zápasoch sa dajú stiahnuť jednoducho, spustením programu oddscaper.py a zadaním skratky danej ligy pre futbal ako parameter.
Skratky sú:
\begin{enumerate}
\item ENG - najvyššia anglická liga (Premier League)
\item GER - najvyššia nemecká liga (Bundesliga)
\item SPA - najvyššia španielska liga (La Liga)
\end{enumerate}
Program stiahne všetky výsledky a kurzy pre všetky zápasy všetkých kompletných sezón tej-ktorej ligy zo stránky www.oddsportal.com.

Tento dataset potom predáme programu \textit{DataMaker.exe} (TODO!) písanom v jazyku C\#, ktorý pretransformuje tieto data na vstupné neuróny pre neurónovú sieť. Všetkých vstupných neurónov je 44, ich význam a poradie je popísané v sekcii Prílohy (\ref{in:foot}). Program taktiež vydá ako posledné tri stĺpce aj výsledok zápasu ako kategorické hodnoty v poradí domáci, remíza, hostia, kde výsledok, ktorý nastal je ohodnotený 1, zvyšné sú 0. (tiež popísané v Prílohe \ref{in:foot}).

Program tiež vytvorí ďalší súbor, ktorý obsahuje testovacie data, teda data, ktoré sa nevyužívajú pri trénovaní siete, ale len pri vyhodnocovaní výsledkov. 
Tieto data sú v rovnakom poradí a musia obsahovať kurzy na dané výsledky a aj výsledok zápasu vo forme troch stĺpcov 
Je to potrebné pre vyhodnocovanie, pretože neurónová sieť bude mať 3 výstupné neuróny v rovnakom poradí a predikovaný výsledok ohodnotí na 1.

Výstup tohto programu predáme programu \textit{DataMaker.exe} (teda ako prvý parameter programu DataMaker.exe je potrebné predať cestu k súboru, ktorý je výstupom súboru oddscraper.py, tento súbor sa volá rovnako ako skratka danej ligy s príponou \textit{.csv}), ktorý je písaný v jazyku C\# a pretransformuje tieto data na vstupné neuróny pre neurónovú sieť. 
Všetkých vstupných neurónov je 44. 
Presné poradie aj popis sa dá nájsť v sekcii Prílohy (Príloha \ref{in:foot}).
Tieto údaje boli vybrané špecificky aj s pomocou súvisiacich prác ako údaje, ktoré popisujú stav oboch tímov, ktoré hrajú proti sebe zápas. 
Bonus predstavujú vstupy označené ako skóre, tieto boli vytvorené mnou ako pokus o jednoduchý a presnejší popis formy pomocou jedného údaju namiesto 10.
Ak bude mať teda jeden z týchto neurónov (alebo obe spoločne) úspech, tak bude možné skrátiť počet vstupných neurónov o 10.
Pre upresnenie, výstupom súboru sú opäť tabuľky formátu csv, názov je zložený zo skratky pre názov danej ligy a slova \textit{input} pre trénovacie data, pre testovacie je to skratka danej ligy a slovo \textit{resinput}.

Cestu na dané súbory potom ako prvé dva parametre (v poradí, v akom sú uvedené v úvode kapitoly) predáme programu \textit{ffnnfootball.py} alebo \textit{rnnfootball.py} podľa toho, či chceme, aby dané údaje vyhodnocovala dopredná rekurentná neurónová sieť.
Výsledky vypíše na štandardný výstup a uloží ich aj do logu, ktorého názov pozostáva z typu siete, názvu ligy a časovej známky vo formáte \textit{txt}.

\section{Tenis}

Údaje o tenisových zápasoch sú predpripravené v súbore atpresults.csv.
Súbor \textit{atpranking.csv} je tiež predpripravený a obsahuje ID jednotlivých hráčov, ich mená a ich poradie v koncoročných rebríčkoch hodnotenia ATP za roky 1999--2018.
Poradie berieme len ak sa hráč umiestnil na miestach 1--100.
Predzápasové kurzy môžu byť prázdne (vyplnené kurzom 0.0), ale len, ak nás na daný zápas nezaujímajú kurzy (zaujímajú nás len pre posledné dva roky, prvý je na testovanie a druhý na vyhodnocovanie). 
Zápasy obsiahnuté v súbore \textit{atpresults.csv} sú len zápasy, v ktorých aspoň jeden hráč bol aspoň raz v daných rokoch na miestach 1--100 v koncoročnom hodnotení ATP.
Predikovať sa budú len zápasy medzi takýmito hráčmi, ale kvôli rôznym výpočtom je potrebné mať všetky data o takýchto hráčoch z turnajov, ktoré sú obsiahnuté v súbore.

Tieto datasety sa potom predajú súboru \textit{ATPDataMaker.exe}, ktorý ich pretransformuje na data pre vstupné neuróny neurónových sietí. Všetkých vstupných neurónov je 37 (ich presné poradie a popis sa dá nájsť v sekcii Prílohy (Príloha \ref{in:ten})), súbor ku každému vstupnému neurónu vydá aj očakávaný výstup (1?, 2?) a pre predikovanú časť dodá aj kurzy stávkových kancelárií na daný výsledok (1B, 2B).
Poradie a význam stĺpcov je popísaný v sekcii Prílohy (\ref{in:ten}).

Z popisu datasetu (v sekcii \ref{ten}) je vidieť, že hráči v zápasoch sú zoradení tak, že najprv je napísaný víťaz a po ňom porazený. To by nám očividne zamiešalo výsledkami a ak by to sieť zistila, tak by okamžite vypisovala úspešnosť 100\,\%.
Presne z tohto dôvodu robí program \textit{ATPDataMaker.exe} aj randomizovanú výmenu poradia hráčov a v ďalšom priebehu sú hráči rozlišovaní ako hráč 1 a hráč 2.

Cestu na dané súbory potom ako prvé tri parametre (v poradí, v akom sú uvedené v úvode sekcie) predáme programu \textit{ffnnatp.py} alebo \textit{rnnatp.py} podľa toho, či chceme, aby dané údaje vyhodnocovala popredná rekurentná neurónová sieť.
Výsledky vypíše na štandardný výstup a uloží ich aj do logu, ktorý je vo formáte \textit{txt} a ktorého názov pozostáva z typu siete, slova \textit{atp} a časovej známky.

